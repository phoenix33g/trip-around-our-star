<html>
<head><title>SharedMemory</title>
<link rel="stylesheet" href="Script.css" type="text/css" />
</head>
<body>
<a href="ScriptRef.html">Script Reference</a>
<h2>SharedMemory</h2>
<h3>Base type</h3>
<a href="DataTypeBase.html">Base</a>
<h3>Description</h3>
A storage object that holds a map of <i>Variant</i> objects indexed by a string.
It can be used for system-wide or scene-wide data sharing.
To access an individual value, use the index operator. Example:
<pre>
' Script 1:
dim a = 123 ' define an integer variable
System.Map["my_global_variable"] = a
'
' Script 2:
dim a = (Integer)System.Map["my_global_variable"]
</pre>

<h3>Properties</h3>
<table border=1 cellpadding=3 cellspacing=0>
<tr><td><b>Eventpool</b> As <a href="DataTypeEventpool.html">Eventpool</a> <i>[read-only]</i></td><td>(<i>Inherited from <a href="DataTypeBase.html">Base</a>)</i> Gets system eventpool.</td></tr>
<tr><td><b>Scene</b> As <a href="DataTypeScene.html">Scene</a> <i>[read-only]</i></td><td>(<i>Inherited from <a href="DataTypeBase.html">Base</a>)</i> Gets the current scene.</td></tr>
<tr><td><b>Stage</b> As <a href="DataTypeStage.html">Stage</a> <i>[read-only]</i></td><td>(<i>Inherited from <a href="DataTypeBase.html">Base</a>)</i> Gets the current stage.</td></tr>
<tr><td><b>System</b> As <a href="DataTypeSystem.html">System</a> <i>[read-only]</i></td><td>(<i>Inherited from <a href="DataTypeBase.html">Base</a>)</i> Gets system wide data.</td></tr>
<tr><td><b>Valid</b> As <a href="DataTypeBoolean.html">Boolean</a> <i>[read-only]</i></td><td>(<i>Inherited from <a href="DataTypeBase.html">Base</a>)</i> Returns true if the object is valid.</td></tr>
<tr><td><b>VizCommunication</b> As <a href="DataTypeVizCommunication.html">VizCommunication</a> <i>[read-only]</i></td><td>(<i>Inherited from <a href="DataTypeBase.html">Base</a>)</i> Gets the VizCommunication object.</td></tr>
<tr><td><b>VizEventName</b> As <a href="DataTypeString.html">String</a> <i>[read-only]</i></td><td>(<i>Inherited from <a href="DataTypeBase.html">Base</a>)</i> The object event name which could be used in <i>registerAsListener</i> and the corresponding callback (the viz object event name could change)</td></tr>
<tr><td><b>VizId</b> As <a href="DataTypeInteger.html">Integer</a></td><td>(<i>Inherited from <a href="DataTypeBase.html">Base</a>)</i> Gets or sets the internal id of this object.</td></tr>
</table>
<h3>Member Procedures</h3>
<table border=1 cellpadding=3 cellspacing=0>
<tr><td>Function <b>ContainsKey</b>(key As <a href="DataTypeString.html">String</a>) As <a href="DataTypeBoolean.html">Boolean</a></td><td>Tests whether an element with the specified key is in the map.</td></tr>
<tr><td>Function <b>CreateKey</b>(key As <a href="DataTypeString.html">String</a>) As <a href="DataTypeBoolean.html">Boolean</a></td><td>Creates a new empty variable.</td></tr>
<tr><td>Function <b>DeleteKey</b>(key As <a href="DataTypeString.html">String</a>) As <a href="DataTypeBoolean.html">Boolean</a></td><td>Deletes a variable.</td></tr>
<tr><td>Function <b>FindChannelOfObject</b>(channelName As <a href="DataTypeString.html">String</a>) As <a href="DataTypeChannel.html">Channel</a></td><td><i>(Inherited from <a href="DataTypeBase.html">Base</a>)</i> Finds an animation channel acting on this object. If this function is called on a type that cannot be animated (such as <i>Director</i>), it returns <i>null</i>. <br>You can limit the search to a particular director by using the syntax "directorName$channelName" for the <i>channelName</i> argument. Nested directors may be specified like this: "directorName1$directorName2$channelName".</td></tr>
<tr><td>Function <b>FindKeyframeOfObject</b>(keyframeName As <a href="DataTypeString.html">String</a>) As <a href="DataTypeKeyframe.html">Keyframe</a></td><td><i>(Inherited from <a href="DataTypeBase.html">Base</a>)</i> Finds a keyframe acting on the object. If this function is called on a type that cannot be animated (such as <i>Director</i>), it returns <i>null</i>. <br>You can limit the search to a particular director by using the syntax "directorName$keyframeName" for the <i>keyframeName</i> argument. Nested directors may be specified like this: "directorName1$directorName2$keyframeName".</td></tr>
<tr><td>Function <b>FindOrCreateChannelOfObject</b>(channelName As <a href="DataTypeString.html">String</a>) As <a href="DataTypeChannel.html">Channel</a></td><td><i>(Inherited from <a href="DataTypeBase.html">Base</a>)</i> This function works like FindChannelOfObject except that if no animation channel with the specifed name exists, a new one is created.</td></tr>
<tr><td>Function <b>GetChannelsOfObject</b>(<em>[out] </em>v As <a href="DataTypeArray.html">Array</a>[<a href="DataTypeChannel.html">Channel</a>]) As <a href="DataTypeInteger.html">Integer</a></td><td><i>(Inherited from <a href="DataTypeBase.html">Base</a>)</i> Fills the array <i>v</i> with the animation channels acting on this object, returning the number of channels. If this function is called on a type that cannot be animated (such as <i>Director</i>), <i>v</i> will be empty.</td></tr>
<tr><td>Sub <b>GetKeys</b>(keys As <a href="DataTypeArray.html">Array</a>[<a href="DataTypeString.html">String</a>])</td><td>Fills the passed array with all defined keys.</td></tr>
<tr><td>Function <b>IsAnimated</b>() As <a href="DataTypeBoolean.html">Boolean</a></td><td><i>(Inherited from <a href="DataTypeBase.html">Base</a>)</i> Returns true if there are animation channels for this object. If this function is called on a type that cannot be animated (such as <i>Director</i>), it always returns <i>false</i>.</td></tr>
<tr><td>Function <b>LoadFromDb</b>(path As <a href="DataTypeString.html">String</a>) As <a href="DataTypeBoolean.html">Boolean</a></td><td>Loads the contents of the map from a database file. The file is specified by <i>path</i>, which must be an absolute path, such as "/User/mem_map".</td></tr>
<tr><td>Function <b>LoadFromDbAsync</b>(path As <a href="DataTypeString.html">String</a>) As <a href="DataTypeBoolean.html">Boolean</a></td><td>Loads the contents of the map from a database file. The file is specified by <i>path</i>, which must be an absolute path, such as "/User/mem_map". This function is called asynchronous, so the value does not have to be loaded when the function returns.</td></tr>
<tr><td>Sub <b>RegisterChangedCallback</b>(key As <a href="DataTypeString.html">String</a>)</td><td>Causes <i>OnSharedMemoryVariableChanged</i> to be invoked whenever the variable identified by <i>key</i> is changed and <i>OnSharedMemoryVariableDeleted</i> in response to the key being deleted. If you pass an empty string for <i>key</i>, the callbacks will be invoked whenever <i>any</i> variable in the map is changed or deleted.</td></tr>
<tr><td>Function <b>SaveToDb</b>(path As <a href="DataTypeString.html">String</a>) As <a href="DataTypeBoolean.html">Boolean</a></td><td>Saves the contents of the map into a database file. The file is specified by <i>path</i>, which must be an absolute path, such as "/User/mem_map". Attention: If you are calling this function with a high frequency (e.g.: in <i>OnExecPerField</i>) then this can result in slow rendering and incomplete GH replications!</td></tr>
<tr><td>Function <b>SaveToDbAsync</b>(path As <a href="DataTypeString.html">String</a>) As <a href="DataTypeBoolean.html">Boolean</a></td><td>Saves the contents of the map into a database file. The file is specified by <i>path</i>, which must be an absolute path, such as "/User/mem_map". This function is called asynchronous, so the value does not have to be stored when the function returns.Attention: asynchronous call</td></tr>
<tr><td>Sub <b>SetChanged</b>()</td><td><i>(Inherited from <a href="DataTypeBase.html">Base</a>)</i> Mark this object as changed.</td></tr>
<tr><td>Function <b>SetValueDelayed</b>(key As <a href="DataTypeString.html">String</a>, value As <a href="DataTypeVariant.html">Variant</a>) As <a href="DataTypeBoolean.html">Boolean</a></td><td>Sets value via the corresponding transport mechanism (e.g. GraphicHub). This prevents possible re-triggering of the OnSharedMemoryVariableChanged callback.</td></tr>
<tr><td>Sub <b>UnregisterChangedCallback</b>(key As <a href="DataTypeString.html">String</a>)</td><td>Removes the binding set up by <i>RegisterChangedCallback</i>.</td></tr>
</table>
</body>
</html>
